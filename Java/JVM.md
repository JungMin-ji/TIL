# JVM(Java Virtual Machine)

JVM이란 자바를 실행하기 위한 가상 머신이다. 가상 머신이란, 소프트웨어로 구현된 하드웨어를 뜻하는 용어이며 소프트웨어로 구현된 컴퓨터로 이해하면 된다. 

자바로 구현된 애플리케이션은 모두 JVM에서만 실행되므로 자바 애플리케이션을 실행할 때 반드시 JVM이 있어야 한다. 

<img src="https://user-images.githubusercontent.com/52596617/191627975-b59a7921-b363-4110-98a0-cddbe7e99aa2.png" width="500" height="300"/>

- 자바 애플리케이션은 JVM을 거치기 때문에 실행 속도가 느리다는 단점이 있다. 하지만, OS에 독립적이라 다른 OS에서도 프로그램의 변경없이 실행 가능하다.
- 대신, JVM은 OS에 종속적이기 때문에 해당 OS에서 실행 가능한 JVM이 필요하다.

# JVM의 구성 요소

JVM은 크게  4가지로 구성된다. 

- 클래스 로더
- 실행 엔진
- 메모리 영역
- 가비지 컬렉터

<img src="https://user-images.githubusercontent.com/52596617/191627999-9254d2b4-e5c7-441e-8c0b-2f4650d711f7.png" width="600" height="400"/>

### 클래스 로더

자바는 동적으로 클래스를 읽어오기 때문에, 런타임 시점에 JVM과 연결된다. 메모리에 한 번에 모든 클래스를 로드하는 것이 아닌, 필요한 순간에 해당 클래스 파일을 찾아 메모리에 동적으로 올려주는 역할을 한다. 

### 메모리 영역(Runtime Data Area)

JVM의 메모리 영역으로 자바 애플리케이션을 실행할 때 사용되는 데이터들을 적재하는 영역이다. 

### 실행 엔진

실행시키는 방법에 따라 크게 두 가지로 분류된다.

- **자바 인터프리터**

컴파일러에 의해 변환된 바이트 코드를 읽고 한 줄 씩 기계어로 해석한다. 

- **JIT 컴파일러**

 전체적인 실행 속도가 느린 인터프리터의 단점을 보완하기 위해 도입되었다. 실행 시점에 인터프리터 방식으로 기계어 코드를 생성하면서 캐싱한다. 나중에 동일한 부분이 호출되면, 캐싱해둔 코드를 사용하여 빠르게 처리할 수 있다. 

- **컴파일 임계치**
    
    JIT 컴파일러는 내부적으로 메서드가 호출될 때마다 호출 횟수를 카운팅해서, 그 횟수가 특정 수치를 초과할 때 캐싱을 수행한다. 
    

### **가비지 컬렉터**

더이상 참조하지 않는 힙 영역의 메모리를 관리해준다. 

# 컴파일 과정

1. 자바 소스 코드(.java)를 작성한다.
2. 자바 컴파일러가 자바 소스 코드(.java)를 읽어 바이트 코드(.class)로 컴파일 한다. 
    - 바이트 코드(.class): JVM이 읽을 수 있는 코드
3. 컴파일된 바이트 코드(.class)를 JVM의 클래스 로더에게 전달한다. 
4. **클래스 로더**는 동적 로딩을 통해 필요한 클래스들을 로딩하고 링크하여 JVM의 메모리에 올린다. 
5. **실행 엔진**은 JVM 메모리에 올라온 바이트 코드들을 명령어 단위로 하나씩 가져와서 실행한다. → (인터프리터, JIT 컴파일러)

## 바이트 코드와 바이너리 코드

- 바이트 코드: 가상 머신이 이해할 수 있는 언어
- 바이너리 코드: 컴퓨터가 인식할 수 있는 0과 1로 구성된 이진 코드

> **.class 파일이 바이트 코드를 담고 있는 것!**
>

# 컴파일 및 실행 방법

1. 자바 소스 파일 작성
2. **javac.exe** 사용하여 .java 파일 컴파일 → .class 파일 생성
    
    `javac 소스 파일명.java`
    
    - javac.exe 실행 파일: 자바 컴파일러 실행 파일
3. **java.exe** 사용하여 .class 파일 실행 
    
    `java 소스 파일명` 
    
    - java.exe 실행 파일: 자바 인터프리터 실행 파일

# JDK와 JRE

## JDK(Java Development Kit)

자바로 소프트웨어를 개발할 수 있도록 여러 기능을 제공하는 키트이다. JDK를 설치하면, JVM과 Java API 등 자바로 개발하는데 필요한 프로그램들이 설치된다. 

## JRE(Java Runtime Environment)

자바로 작성된 응용 프로그램이 실행되기 위한 최소 환경이다. 
> JDK는 JRE를 포함하는 개념으로, 자바로 개발하기 위해서는 JDK를 설치해야 하고 자바를 실행하기 위해서는 JRE를 설치해야 한다.
>
